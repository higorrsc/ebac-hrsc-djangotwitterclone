{% load static %}

<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />
    <title>Twitter Clone</title>
    {% comment %}
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" />
    {% endcomment %}
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    {% comment %}
    <link rel="stylesheet" href="{% static 'css/bootstrap-icons.min.css' %}" />
    {% endcomment %}
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <style>
      body {
        transition: background-color 0.3s, color 0.3s;
      }
    </style>
    <script>
      // Immediately set the theme to avoid flickering
      (function () {
        const prefersDarkTheme = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        const defaultTheme = prefersDarkTheme ? "dark" : "light";
        const storedThemePreference = localStorage.getItem(
          "django-twitter-clone-theme"
        );
        const themeToApply = storedThemePreference || defaultTheme;
        document.documentElement.setAttribute("data-bs-theme", themeToApply);
      })();
    </script>
  </head>
  <body>
    {% include "navbar.html" %}
    <div class="container-fluid p-2">{% block content %} {% endblock %}</div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Detect system theme preference
        const prefersDarkTheme = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        // Determine default theme based on system preference
        const defaultTheme = prefersDarkTheme ? "dark" : "light";
        // Retrieve stored theme preference (if any)
        const storedThemePreference = localStorage.getItem(
          "django-twitter-clone-theme"
        );
        // Apply the appropriate theme
        const themeToApply = storedThemePreference || defaultTheme;
        document.documentElement.setAttribute("data-bs-theme", themeToApply);
        // Update UI elements based on the applied theme (optional)
        if (themeToApply === "dark") {
          document.getElementById("sun").classList.add("d-none");
          document.getElementById("moon").classList.remove("d-none");
        } else {
          document.getElementById("sun").classList.remove("d-none");
          document.getElementById("moon").classList.add("d-none");
        }
        // Event listener for theme toggle button (optional)
        document.getElementById("switchTheme").addEventListener("click", () => {
          const currentTheme =
            document.documentElement.getAttribute("data-bs-theme");
          const newTheme = currentTheme === "dark" ? "light" : "dark";
          // Set selected theme
          document.documentElement.setAttribute("data-bs-theme", newTheme);
          // Update localStorage with the new theme preference
          localStorage.setItem("django-twitter-clone-theme", newTheme);
          // Update UI elements based on the new theme
          if (newTheme === "dark") {
            document.getElementById("sun").classList.add("d-none");
            document.getElementById("moon").classList.remove("d-none");
          } else {
            document.getElementById("sun").classList.remove("d-none");
            document.getElementById("moon").classList.add("d-none");
          }
        });
      });
    </script>
    {% comment %}
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    {% endcomment %}
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    {% comment %}
    <script src="{% static 'js/jquery.min.js' %}"></script>
    {% endcomment %}
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    {% comment %}
    <script src="{% static 'js/jquery.formset.js' %}"></script>
    {% endcomment %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.formset/1.2.2/jquery.formset.min.js"></script>
    {% block scripts %} {% endblock %}
  </body>
</html>
